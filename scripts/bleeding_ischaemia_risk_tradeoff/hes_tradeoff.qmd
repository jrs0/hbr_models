---
title: "Bleeding/Ischaemia Risk Trade-off Models"
project:
  output-dir: _output
execute:
  echo: false
  warning: false
format:
  pdf
jupyter: python3
fig-format: png
---

```{python}
import os

os.chdir("../prototypes")

import matplotlib.pyplot as plt
from IPython.display import display, Markdown

import save_datasets as ds
from stability import plot_instability
from calibration import (
    get_bootstrapped_calibration,
    plot_calibration_curves,
    plot_prediction_distribution,
)
from plot_model import plot_model_validation_2page
from roc import get_bootstrapped_roc, get_bootstrapped_auc, plot_roc_curves

dataset_names = {
    "manual_codes": "HES (manual code groups)",
    "all_codes": "HES (all codes)",
    "manual_codes_swd": "HES (manual code groups) + SWD",
}
model_names = {
    "simple_logistic_regression": "Logistic Regression",
    "truncsvd_logistic_regression": "Truncated SVD + Logistic Regress",
}
outcome_names = {
    "bleeding_al_ani_outcome": "bleeding",
    "hussain_ami_stroke_outcome": "AMI and stroke",
}
```

# Introduction

# Literature

# Hospital Episode Statistics

The basic dataset used to define the index event, the outcome variable, and a preliminary set of features is Hospital Episode Statistics. Rows in the raw dataset are episodes (single consultant interactions) collected into spells (single hospital visits). Each episode contains a list of up 26 diagnosis codes (ICD-10) and 26 procedure codes (OPCS-4), which define what happened in the episode.

## Dataset Definitions

## Bleeding Models

```{python}
# | output: asis
outcome = "bleeding_al_ani_outcome"

for model_name in model_names:
    display(Markdown("{{< pagebreak >}}"))
    display(Markdown(f"### {model_name}"))
    plot_model_validation_2page(model_name, outcome)
```

## Ischaemia Models

```{python}
# | output: asis
outcome = "hussain_ami_stroke_outcome"

for model_name in model_names:
    print("{{< pagebreak >}}")
    print(f"### {model_name}")
    plot_model_validation_2page(model_name, outcome)
```

## Risk Trade-off Model

# Discussion

# Conclusion